var documenterSearchIndex = {"docs":
[{"location":"#RestrictedBoltzmannMachines.jl-Documentation","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"","category":"section"},{"location":"#Restricted-Boltzmann-Machines","page":"RestrictedBoltzmannMachines.jl Documentation","title":"Restricted Boltzmann Machines","text":"","category":"section"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"We consider a restricted Boltzmann machine (RBM) with visible units mathbfv = (v_1 ldots v_N) and hidden units mathbfh = (h_1 ldots h_M). The energy function is given by:","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"E(mathbfv mathbfh) = sum_i mathcalV_i(v_i) + sum_mumathcalU_mu(h_mu) - sum_imu w_imu v_i h_mu","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"where mathcalV_i(v_i) and mathcalU_mu(h_mu) are the unit potentials and w_imu the interaction weights. The probability of a configuration is","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"P(mathbfv mathbfh) = frac1Zmathrme^-beta E(mathbfvmathbfh)","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"where","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"Z = sum_mathbfv mathbfh mathrme^-beta E(mathbfv mathbfh)","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"is the partition function and beta the inverse temperature. The machine assigns a likelihood:","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"P(mathbfv) = undersetmathbfhsum P (mathbfv mathbfh) =\nfrac1Z mathrme^-beta E_textrmeff(mathbfv)","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"to visible configurations, where E_textrmeff(mathbfv) is the free energy:","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"E_textrmeff(mathbfv) = sum_i mathcalV_i(v_i) - sum_mu\nGamma_mu left(sum_i w_i mu v_i right)","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"and","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"Gamma_mu(I) = frac1beta ln sum_h_mu mathrme^beta(I h_mu - mathcalU_mu(h_mu))","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"are the cumulant generating functions associated to the hidden unit potentials.","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"Note that beta refers to the inverse temperature in the distribution P(mathbfvmathbfh). If instead we want to sample the marginal P(mathbfv) at a different inverse temperature beta_v,  we would have to use the distribution:","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"P_beta_v(mathbfv) = fracmathrme^- beta_v E_textrmeff\n(mathbfv)sum_mathbfv mathrme^-beta_mathrmv E_textrmeff\n(mathbfv)","category":"page"},{"location":"#Reference","page":"RestrictedBoltzmannMachines.jl Documentation","title":"Reference","text":"","category":"section"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"This package doesn't export any symbols. To make names shorter, we will import the package as RBMs:","category":"page"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"import RestrictedBoltzmannMachines as RBMs","category":"page"},{"location":"#RBMs","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RBMs","text":"","category":"section"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"RBMs.RBM\nRBMs.energy\nRBMs.free_energy\nRBMs.interaction_energy\nRBMs.inputs_v_to_h\nRBMs.inputs_h_to_v\nRBMs.sample_h_from_v\nRBMs.sample_v_from_h\nRBMs.sample_v_from_v\nRBMs.sample_h_from_h","category":"page"},{"location":"#RestrictedBoltzmannMachines.RBM","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.RBM","text":"RBM\n\nRepresents a restricted Boltzmann Machine.\n\n\n\n\n\n","category":"type"},{"location":"#RestrictedBoltzmannMachines.energy","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.energy","text":"energy(rbm, v, h)\n\nEnergy of the rbm in the configuration (v,h).\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.free_energy","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.free_energy","text":"free_energy(rbm, v, β=1)\n\nFree energy of visible configuration (after marginalizing hidden configurations).\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.interaction_energy","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.interaction_energy","text":"interaction_energy(rbm, v, h)\n\nWeight mediated interaction energy.\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.inputs_v_to_h","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.inputs_v_to_h","text":"inputs_v_to_h(rbm, v)\n\nInteraction inputs from visible to hidden layer.\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.inputs_h_to_v","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.inputs_h_to_v","text":"inputs_h_to_v(rbm, h)\n\nInteraction inputs from hidden to visible layer.\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.sample_h_from_v","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.sample_h_from_v","text":"sample_h_from_v(rbm, v, β=1)\n\nSamples a hidden configuration conditional on the visible configuration v.\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.sample_v_from_h","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.sample_v_from_h","text":"sample_v_from_h(rbm, h, β = 1)\n\nSamples a visible configuration conditional on the hidden configuration h.\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.sample_v_from_v","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.sample_v_from_v","text":"sample_v_from_v(rbm, v, β = 1; steps = 1)\n\nSamples a visible configuration conditional on another visible configuration v.\n\n\n\n\n\n","category":"function"},{"location":"#RestrictedBoltzmannMachines.sample_h_from_h","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.sample_h_from_h","text":"sample_h_from_h(rbm, h, β = 1; steps = 1)\n\nSamples a hidden configuration conditional on another hidden configuration h.\n\n\n\n\n\n","category":"function"},{"location":"#Layers","page":"RestrictedBoltzmannMachines.jl Documentation","title":"Layers","text":"","category":"section"},{"location":"","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.jl Documentation","text":"RBMs.Gaussian","category":"page"},{"location":"#RestrictedBoltzmannMachines.Gaussian","page":"RestrictedBoltzmannMachines.jl Documentation","title":"RestrictedBoltzmannMachines.Gaussian","text":"Gaussian(θ, γ)\n\nGaussian layer, with location parameters θ and scale parameters γ.\n\n\n\n\n\n","category":"type"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"EditURL = \"https://github.com/cossio/RestrictedBoltzmannMachines.jl/blob/master/docs/literate/mnist.jl\"","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"using CairoMakie\nimport MLDatasets\nimport RestrictedBoltzmannMachines as RBMs","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"First we load the MNIST dataset.","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"train_x, train_y = MLDatasets.MNIST.traindata();\ntests_x, tests_y = MLDatasets.MNIST.testdata();\nnothing #hide","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"We will train an RBM with binary (0,1) visible and hidden units. Therefore we binarize the data first.","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"train_x = float(train_x .≥ 0.5);\ntests_x = float(tests_x .≥ 0.5);\ntrain_y = float(train_y);\ntests_y = float(tests_y);\nnothing #hide","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"Initialize an RBM with 100 hidden units.","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"rbm = RBMs.RBM(RBMs.Binary(28,28), RBMs.Binary(100), randn(28, 28, 100) / 28);\nnothing #hide","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"Train the RBM on the data. This returns a MVHistory object (from https://github.com/JuliaML/ValueHistories.jl), containing things like the pseudo-likelihood of the data during training.","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"history = RBMs.train!(rbm, train_x; epochs=10, batchsize=128);\nnothing #hide","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"Plot log-pseudolikelihood during learning.","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"lines(get(history, :lpl)...)","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"","category":"page"},{"location":"literate/mnist/","page":"mnist","title":"mnist","text":"This page was generated using Literate.jl.","category":"page"}]
}
