var documenterSearchIndex = {"docs":
[{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"EditURL = \"https://github.com/cossio/RestrictedBoltzmannMachines.jl/blob/master/docs/src/literate/MNIST.jl\"","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"using CairoMakie\nimport MLDatasets\nimport RestrictedBoltzmannMachines as RBMs","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"First we load the MNIST dataset.","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"train_x, train_y = MLDatasets.MNIST.traindata()\ntests_x, tests_y = MLDatasets.MNIST.testdata()\nnothing #hide","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"We will train an RBM with binary (0,1) visible and hidden units. Therefore we binarize the data first.","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"train_x = float(train_x .≥ 0.5)\ntests_x = float(tests_x .≥ 0.5)\ntrain_y = float(train_y)\ntests_y = float(tests_y)\nnothing #hide","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"Initialize an RBM with 100 hidden units.","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"rbm = RBMs.RBM(RBMs.Binary(28,28), RBMs.Binary(100), randn(28, 28, 100) / 28)\nnothing #hide","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"Train the RBM on the data. This returns a MVHistory object (from ValueHistories.jl), containing things like the pseudo-likelihood of the data during training. We print here the time spent in the training as a rough benchmark.","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"history = RBMs.train!(rbm, train_x[:,:,1:512]; epochs=10, batchsize=128)\nnothing #hide","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"Plot log-pseudolikelihood during learning.","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"lines(get(history, :lpl)...)","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"","category":"page"},{"location":"literate/MNIST/","page":"MNIST","title":"MNIST","text":"This page was generated using Literate.jl.","category":"page"},{"location":"reference/#RestrictedBoltzmannMachines.jl-Reference","page":"Reference","title":"RestrictedBoltzmannMachines.jl Reference","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [RestrictedBoltzmannMachines]","category":"page"},{"location":"math/#Mathematical-introduction-to-Restricted-Boltzmann-Machines","page":"Mathematical introduction","title":"Mathematical introduction to Restricted Boltzmann Machines","text":"","category":"section"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"A restricted Boltzmann machine (RBM) with visible units mathbfv = (v_1 ldots v_N) and hidden units mathbfh = (h_1 ldots h_M) has an energy function defined by:","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"E(mathbfv mathbfh) = sum_i mathcalV_i(v_i) + sum_mumathcalU_mu(h_mu) - sum_imu w_imu v_i h_mu","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"where mathcalV_i(v_i) and mathcalU_mu(h_mu) are the unit potentials and w_imu the interaction weights. The probability of a configuration is:","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"P(mathbfv mathbfh) = frac1Zmathrme^-beta E(mathbfvmathbfh)","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"where","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"Z = sum_mathbfv mathbfh mathrme^-beta E(mathbfv mathbfh)","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"is the partition function and beta the inverse temperature. The machine assigns a likelihood:","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"P(mathbfv) = undersetmathbfhsum P (mathbfv mathbfh) =\nfrac1Z mathrme^-beta E_textrmeff(mathbfv)","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"to visible configurations, where E_textrmeff(mathbfv) is the free energy:","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"E_textrmeff(mathbfv) = sum_i mathcalV_i(v_i) - sum_mu\nGamma_mu left(sum_i w_i mu v_i right)","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"and","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"Gamma_mu(I) = frac1beta ln sum_h_mu mathrme^beta(I h_mu - mathcalU_mu(h_mu))","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"are the cumulant generating functions associated to the hidden unit potentials.","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"Note that beta refers to the inverse temperature in the distribution P(mathbfvmathbfh). If instead we want to sample the marginal P(mathbfv) at a different inverse temperature beta_v,  we would have to use the distribution:","category":"page"},{"location":"math/","page":"Mathematical introduction","title":"Mathematical introduction","text":"P_beta_v(mathbfv) = fracmathrme^- beta_v E_textrmeff\n(mathbfv)sum_mathbfv mathrme^-beta_mathrmv E_textrmeff\n(mathbfv)","category":"page"},{"location":"#RestrictedBoltzmannMachines.jl-Documentation","page":"Home","title":"RestrictedBoltzmannMachines.jl Documentation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"A Julia package to train and simulate Restricted Boltzmann Machines.","category":"page"},{"location":"","page":"Home","title":"Home","text":"This package doesn't export any symbols. It is recommended to import the package as:","category":"page"},{"location":"","page":"Home","title":"Home","text":"import RestrictedBoltzmannMachines as RBMs","category":"page"},{"location":"","page":"Home","title":"Home","text":"to avoid typing the long name.","category":"page"}]
}
